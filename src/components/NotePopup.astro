---
const { note } = Astro.props;
---

<div class="note-card-wrapper">
  <div class="note-card">
    {note.image && <img src={note.image} class="note-image" />}
    <p style="margin-top: 2px;">{note.heading}</p>
    <h3 class="note-title">{note.title}</h3>
    <p>{note.summary}</p>
  </div>

  <div class="popup-overlay hidden">
    <img src="/images/clip.svg" alt="Clip" class="clip-img-popup" />
    <div class="popup-content">
      <span class="popup-close">âœ•</span>
      {
        note.images && (
          <img
            src={note.images}
            alt={note.title}
            style="max-width:514px; display:block; margin:0 auto ;"
          />
        )
      }
      <h1>{note.title}</h1>
      <div class="note-body" set:html={note.content} />
    </div>
  </div>
</div>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    document.querySelectorAll(".note-card-wrapper").forEach((wrapper) => {
      const card = wrapper.querySelector(".note-card");
      const popup = wrapper.querySelector(".popup-overlay");
      const closeBtn = wrapper.querySelector(".popup-close");
      const popupContent = wrapper.querySelector(".popup-content");

      if (card && popup && closeBtn && popupContent) {
        card.addEventListener("click", () => popup.classList.remove("hidden"));
        popup.addEventListener("click", () => popup.classList.add("hidden"));
        closeBtn.addEventListener("click", (e) => {
          e.stopPropagation();
          popup.classList.add("hidden");
        });
        popupContent.addEventListener("click", (e) => e.stopPropagation());
      }
    });
  });
</script>

<style>
  .note-card-wrapper {
    display: inline-block; /* important for columns to work */
    width: 100%;
    margin-bottom: 36px;
    min-height: 100%;
    width: 300px;
  }

  /* Card Styles */
  .note-card {
    background: #dccef9;
    border-radius: 12px;
    padding: 18px;
    cursor: pointer;
    transition: transform 0.2s ease;
    font-size: 16px;
  }
  .note-card:hover {
    transform: translateY(-5px) scale(1.03);
    box-shadow: 0 8px 28px rgba(80, 69, 134, 0.16);
  }

  .note-title {
    font-family: "itc-benguiat", serif;
    font-weight: 500;
    font-size: 24px;
    margin: 24px auto;
  }
  .note-card img {
    width: 100%;
    border-radius: 8px;
    margin-bottom: 12px;
    object-fit: cover;
  }

  /* Popup Styles */
  .popup-overlay {
    position: fixed;
    inset: 0;
    background: rgba(80, 69, 134, 0.45);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 9999;
  }
  .popup-overlay.hidden {
    display: none;
  }
  .popup-content {
    background: #dccef9;
    padding: 32px 24px;
    max-width: 673px;
    min-width: 320px;
    border-radius: 16px;
    box-shadow: 0 20px 48px rgba(80, 69, 134, 0.25);
    position: relative;
    max-height: 92vh;
    overflow: auto;
    text-align: center;
    position: relative;
  }

  .clip-img-popup {
    position: absolute;
    top: 12px;
    left: 395px;
    width: 80px;
    height: auto;
    z-index: 101;
    pointer-events: none;
  }

  .popup-close {
    position: absolute;
    right: 18px;
    top: 18px;
    font-size: 1.6rem;
    cursor: pointer;
    color: #3e4146;
    z-index: 10;
    padding: 2px;
    border-radius: 8px;
    border: none;
    transition: background 0.2s;
  }
  .popup-close:hover {
    background-color: #f9f6f0;
    color: #3e4146;
  }
  .note-body {
    margin-top: 18px;
    color: #3e4146;
    font-size: 1.08rem;
    line-height: 1.6;
    text-align: left;
  }
  @media (min-width: 600px) {
    .popup-content {
      padding: 40px 48px;
    }
  }
</style>
